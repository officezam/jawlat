(function(a){a(function(){var d;var f=a("#els_listing_gallery_images");var e=a("#listing_gallery_container ul.listing_images");a(".add_listing_images").on("click","a",function(h){var g=a(this);var i=f.val();h.preventDefault();if(d){d.open();return}d=wp.media.frames.listing_gallery=wp.media({title:g.data("choose"),button:{text:g.data("update"),},states:[new wp.media.controller.Library({title:g.data("choose"),filterable:"all",multiple:true,})]});d.on("select",function(){var k=d.state().get("selection");var j;k.map(function(l){l=l.toJSON();if(l.id){i=i?i+","+l.id:l.id;j=l.sizes.thumbnail?l.sizes.thumbnail.url:l.url;e.append('	 						<li class="image" data-attachment_id="'+l.id+'">	 							<img src="'+j+'" />	 							<ul class="actions">	 								<li><a href="#" class="delete" title="'+g.data("delete")+'">'+g.data("text")+"</a></li>	 							</ul>	 						</li>")}});f.val(i)});d.open()});e.sortable({items:"li.image",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:true,forceHelperSize:false,helper:"clone",opacity:0.65,placeholder:"els-metabox-sortable-placeholder",start:function(g,h){h.item.css("background-color","#f6f6f6")},stop:function(g,h){h.item.removeAttr("style")},update:function(g,h){var i="";a("#listing_gallery_container ul li.image").css("cursor","default").each(function(){var j=jQuery(this).attr("data-attachment_id");i=i+j+","});f.val(i)}});a("#listing_gallery_container").on("click","a.delete",function(){a(this).closest("li.image").remove();var g="";a("#listing_gallery_container ul li.image").css("cursor","default").each(function(){var h=jQuery(this).attr("data-attachment_id");g=g+h+","});f.val(g);a("#tiptip_holder").removeAttr("style");a("#tiptip_arrow").removeAttr("style");return false});var c={init:function(){this.previewSlider()},previewSlider:function(){a("body").on("click","a.slider-preview-action",function(h){h.preventDefault();var g=a(this).data("id");tb_show(a(this).data("text"),a(this).prop("href")+"&width="+(a(window).width()-50)+"&height="+(a(window).height()-80)+"&TB_iframe=true")})}};c.init();jQuery(".help_tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200});var b={init:function(){this.openPopup();this.closePopup();this.subscribe()},openPopup:function(){a("[data-popup=popup-1]").fadeIn("slow")},closePopup:function(){a("[data-popup-close]").on("click",function(h){var g=jQuery(this).attr("data-popup-close");a('[data-popup="'+g+'"]').fadeOut(350);h.preventDefault()})},subscribe:function(){a("#subscribe").click(function(h){var g=false;if(!jQuery.trim(jQuery("#name").val())){jQuery("#name").addClass("error-field");g=true}else{jQuery("#name").removeClass("error-field")}if(!b.validateEmail(a("#email").val())){jQuery("#email").addClass("error-field");g=true}else{jQuery("#email").removeClass("error-field")}if(!g){b.showMessage("Please wait...",0);a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"send_subscribe_email",subscribe_nonce:elsAdminData.subscribe_nonce,name:jQuery.trim(jQuery("#name").val()),email:a("#email").val()},}).done(function(i){b.showMessage(i.message,i.success);a("[data-popup=popup-1]").delay(2500).fadeOut("slow")}).fail(function(i){b.showMessage("Some error occurred in subscription.",0)})}})},validateEmail:function(g){var h=/^([a-zA-Z0-9_.+-])+\@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return h.test(g)},showMessage:function(h,g){jQuery("#popup-message").css("padding","3px");jQuery("#popup-message").html("");jQuery("#popup-message").html(h);jQuery("#popup-message").show();if(1==g){jQuery("#popup-message").css("border","1px solid rgb(60, 221, 60)")}else{jQuery("#popup-message").css("border","1px solid rgb(221, 60, 91)")}}};b.init()})})(jQuery);
